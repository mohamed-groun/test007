{% extends 'base.html.twig' %}
{% trans_default_domain 'Register' %}
{% block title %}{{ 'title'|trans }}{% endblock %}

{% block body %}
    <div class="container d-flex align-items-center justify-content-center vh-100">
        <div class="card shadow-lg p-4" style="max-width: 450px; width: 100%; border-radius: 15px;">
            <div class="text-center mb-4">
                <h2 class="fw-bold">{{ 'create_account'|trans }}</h2>
                <p class="text-muted">{{ 'fill_form'|trans }}</p>
            </div>

            {{ form_start(registrationForm, {'attr': {'novalidate': 'novalidate'}}) }}

            {# Erreurs globales #}
            {% for error in registrationForm.vars.errors %}
                <div class="alert alert-danger">{{ error.message }}</div>
            {% endfor %}

            {# Email #}
            <div class="mb-3">
                <label for="{{ registrationForm.email.vars.id }}" class="form-label">{{ 'email'|trans }}</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                    {% set emailClass = registrationForm.email.vars.errors|length > 0 ? 'form-control form-control-lg is-invalid' : 'form-control form-control-lg' %}
                    {{ form_widget(registrationForm.email, {'attr': {'class': emailClass, 'placeholder': 'email'|trans}}) }}
                    <div class="invalid-feedback">
                        {{ form_errors(registrationForm.email)|join('<br>')|raw }}
                    </div>
                </div>
            </div>

            {# Pr√©nom #}
            <div class="mb-3">
                <label for="{{ registrationForm.firstname.vars.id }}" class="form-label">{{ 'firstname'|trans }}</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-person"></i></span>
                    {% set firstnameClass = registrationForm.firstname.vars.errors|length > 0 ? 'form-control form-control-lg is-invalid' : 'form-control form-control-lg' %}
                    {{ form_widget(registrationForm.firstname, {'attr': {'class': firstnameClass, 'placeholder': 'firstname'|trans}}) }}
                    <div class="invalid-feedback">
                        {{ form_errors(registrationForm.firstname)|join('<br>')|raw }}
                    </div>
                </div>
            </div>

            {# Nom #}
            <div class="mb-3">
                <label for="{{ registrationForm.lastname.vars.id }}" class="form-label">{{ 'lastname'|trans }}</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-person-badge"></i></span>
                    {% set lastnameClass = registrationForm.lastname.vars.errors|length > 0 ? 'form-control form-control-lg is-invalid' : 'form-control form-control-lg' %}
                    {{ form_widget(registrationForm.lastname, {'attr': {'class': lastnameClass, 'placeholder': 'lastname'|trans}}) }}
                    <div class="invalid-feedback">
                        {{ form_errors(registrationForm.lastname)|join('<br>')|raw }}
                    </div>
                </div>
            </div>

            {# Mot de passe #}
            <div class="mb-3">
                <label for="{{ registrationForm.plainPassword.vars.id }}" class="form-label">{{ 'password'|trans }}</label>
                <div class="input-group">
                    <span class="input-group-text"><i class="bi bi-lock"></i></span>
                    {% set passwordClass = registrationForm.plainPassword.vars.errors|length > 0 ? 'form-control form-control-lg is-invalid' : 'form-control form-control-lg' %}
                    {{ form_widget(registrationForm.plainPassword, {'attr': {'class': passwordClass, 'placeholder': 'password'|trans}}) }}
                    <div class="invalid-feedback">
                        {{ form_errors(registrationForm.plainPassword)|join('<br>')|raw }}
                    </div>
                </div>
            </div>

            {# Checkbox "agreeTerms" obligatoire #}
            <div class="form-check mb-3">
                {% set agreeClass = registrationForm.agreeTerms.vars.errors|length > 0 ? 'form-check-input is-invalid' : 'form-check-input' %}
                {{ form_widget(registrationForm.agreeTerms, {'attr': {'class': agreeClass}}) }}
                {{ form_label(registrationForm.agreeTerms, 'agree_terms'|trans, {'label_attr': {'class': 'form-check-label'}}) }}
                <div class="invalid-feedback d-block">
                    {{ form_errors(registrationForm.agreeTerms)|join('<br>')|raw }}
                </div>
            </div>

            <button type="submit" class="btn btn-primary btn-lg w-100 mb-3 btn-animate">{{ 'submit'|trans }}</button>

            <div class="text-center">
                <span class="text-muted">{{ 'already_account'|trans }}</span>
                <a href="{{ path('app_login') }}">{{ 'login_here'|trans }}</a>
            </div>

            {{ form_end(registrationForm) }}
        </div>
    </div>

    <!-- CSS pour moderniser -->
    <style>
        body {
            background-color: rgba(240, 240, 240, 0.7);
            background-image: radial-gradient(#ccc 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .card {
            background-color: #fff;
            border-radius: 15px;
        }

        .form-control:focus {
            border-color: #0d6efd;
            box-shadow: 0 0 8px rgba(108, 99, 255, 0.3);
        }

        .is-invalid {
            border-color: #dc3545 !important;
        }

        .invalid-feedback {
            color: #dc3545 !important;
            font-size: 0.875rem;
        }

        .btn-animate {
            transition: all 0.3s ease;
        }

        /* Responsive pour mobile */
        @media (max-width: 576px) {
            .card {
                padding: 2rem 1rem;
            }
            .form-control {
                font-size: 0.95rem;
            }
        }
    </style>
{% endblock %}
